<mat-card class="card">
    <div class="img">
      <ng-container *ngIf="user.updateInfo.photo; else defaultPhoto">
        <img src="{{user.updateInfo.photo}}" alt="photo" class="photo">
      </ng-container>
      <ng-template #defaultPhoto>
        <img src="../../assets/img/default-user.png" alt="photo" class="photo">
      </ng-template>
      <i (click)="switchToUpdate()" class="material-icons profile-edit-btn"
         matTooltip="Edit profile">edit</i>
    </div>
    <div class="card_header">
        <div class="card_header_title">
            <mat-icon aria-hidden="false" aria-label="Example home icon">home</mat-icon>
            <h2 class="title_name">{{user.userName}}</h2>
        </div>
        <mat-tab-group dynamicHeight (focusChange)="loadOrders()">
            <mat-tab>
              <ng-template matTabLabel>
                <span><i class="material-icons">account_circle</i> My profile </span>
              </ng-template>
              <div class="profile">
                <div class="profile_title"><i class="material-icons">perm_identity</i>{{user.userName}}</div>
                <div class="profile_title"><i class="material-icons">email</i>{{user.userEmail}}</div>
                <ng-container *ngIf="user.updateInfo.years">
                  <div class="profile_title"><i class="material-icons">cake</i>{{user.updateInfo.years | date}}</div>
                  <div class="profile_title"><i class="material-icons">location_on </i>{{user.updateInfo.address}}</div>
                  <div class="profile_title"><i class="material-icons">pets</i>{{user.updateInfo.animals.join(', ')}}</div>
                </ng-container>
              </div>
            </mat-tab>
            <mat-tab>
              <ng-template matTabLabel >
                <span><i class="material-icons">book</i> My responses</span>
              </ng-template>
              <ng-container *ngIf="responses.length > 0; else empty">
                <mat-card class="response" *ngFor="let book of responses">
                  <ng-container *ngIf="book.isBooked && !book.isComplete">
                    <p class="response_text" >
                      {{book.sitterName}} accepted your offer. <span class="status-badge active">Active</span>
                      <span matTooltip="Delete offer" class="material-icons" (click)="onDecline(book['_id'])">delete_forever</span>
                    </p>
                    <p class="message">Your message: {{book.contactInfo}} </p>
                  </ng-container>
                  <ng-container *ngIf="!book.isBooked && !book.isComplete">
                    <p class="response_text">
                      {{book.sitterName}} not replied to your offer yet. <span class="status-badge pending">Pending</span>
                      <span matTooltip="Delete offer" class="material-icons" (click)="onDecline(book['_id'])">delete_forever</span>
                    </p>
                    <p class="message">Your message: {{book.contactInfo}} </p>
                  </ng-container>
                  <ng-container *ngIf="book.isComplete">
                    <p class="response_text">
                      {{book.sitterName}} completed your order. <span class="status-badge inactive">Inactive</span>
                      <span matTooltip="Delete offer" class="material-icons" (click)="onDecline(book['_id'])">delete_forever</span>
                    </p>
                    <p class="message">Your message: {{book.contactInfo}} </p>
                  </ng-container>
                </mat-card>
              </ng-container>
              <ng-template #empty>
                <p class="empty">You have no active orders or users have not accepted your offers</p>
              </ng-template>
            </mat-tab>
            <mat-tab>
              <ng-template matTabLabel>
                <span> <i class="material-icons">assignment</i> My advert </span>
              </ng-template>
              <ng-container *ngIf="myOrders.length > 0; else emptyOrders">
                <ng-container *ngFor="let order of myOrders">
                  <mat-card class="orders">
                    <p class="orders_title">Title: <span class="orders_descr">{{order.title}}</span></p>
                    <p class="orders_title">Information: <span class="orders_descr">{{order.info}}</span></p>
                    <p class="orders_title">Animals: <span class="orders_descr">{{order.pet}}</span></p>
                    <p class="orders_title">Services: <span class="orders_descr">{{order.services}}</span></p>
                    <p class="orders_offres">Your offers </p>
                    <i class="material-icons clear_icon-block" (click)="onDeleteOffer(order._id)">clear</i>
                    <ng-container *ngIf="order.offers.length > 0; else emptyOffers">
                      <mat-card class="book" *ngFor="let offer of order.offers">
                        <div class="book_descr">{{getUser(offer).name}}</div>
                        <div class="book_descr">{{getUser(offer).email}}</div>
                        <button mat-raised-button color="primary"
                          (click)="bookSitter(offer, order.info, order._id)"
                        >Book</button>
                        <i class="material-icons clear_icon-elem" (click)="onRemoveOffer(order._id, offer)">clear</i>
                      </mat-card>
                    </ng-container>
                    <ng-template #emptyOffers>
                      <p class="empty_offers">You do not have any offers yet.</p>
                    </ng-template>
                  </mat-card>
                </ng-container>
              </ng-container>
              <ng-template #emptyOrders>
                <p class="empty_orders">You do not have any orders yet. You can create your order <a [routerLink]="'/board'">here</a></p>
              </ng-template>
            </mat-tab>
          </mat-tab-group>
    </div>
</mat-card>
