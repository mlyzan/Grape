<grape-filter-sitters></grape-filter-sitters>

  <div class="error" *ngIf="error$ | async">
    <div class="error_ops">Ooops!</div>
    Something wrong. Please try again later.
  </div>
  <ng-container *ngIf="sitters$ | async">
    <mat-card class="sitter" *ngFor="let sitter of sitters$ | async">
      <div class="img">
        <ng-container *ngIf="sitter.photo; else defaultPhoto">
          <img mat-card-image [src]="sitter.photo" alt="photo" />
          <div class="rate">
            <ngx-stars [readonly]="activeId && sitter.userId !== activeId ? false : true" [maxStars]="5" [initialStars]="sitter.rate"
            [color]="'#FFC92A'" [wholeStars]="false" (ratingOutput)="onRatingSet(sitter.userId, $event)"></ngx-stars>
            <div *ngIf="sitter.rate > 0.4" class="rate_num">Rate: {{sitter.rate | number:'1.0-2'}}</div>
          </div>
        </ng-container>
        <ng-template #defaultPhoto>
          <img
            mat-card-image
            src="../../assets/img/default-user.png"
            alt="photo"
          />
        </ng-template>
      </div>
      <mat-card-content class="description">
        <mat-card-title class="name">
          <i class="material-icons">person_pin</i>
          {{ sitter.userName }}
        </mat-card-title>
        <mat-card-content class="information">
          <div class="payment">
            <i class="material-icons">attach_money</i>
            {{ sitter.payment | currency }} per hour
          </div>
          <div class="location">
            <i class="material-icons">location_on</i>
            {{ sitter.address }}
          </div>
          <div class="animals">
            <i class="material-icons">pets</i>
            {{ sitter.animals }}
          </div>
          <div class="services">
            <i class="material-icons">room_service</i>
            {{ sitter.services }}
          </div>
          <div class="about">
            <i class="material-icons"> create</i>
            {{ sitter.information }}
          </div>
        </mat-card-content>
        <button
          class="btn"
          mat-raised-button
          color="primary"
          (click)="onShow(sitter.userId)"
        >
          <i class="material-icons">pets</i>Show comments
        </button>

        <mat-card-footer *ngIf="isShowComments && sitter.userId === currentSitterCommentId">
          <h2>Comments</h2>
          <mat-form-field class="comment">
            <mat-label>Leave a comment</mat-label>
            <input #newComment matInput maxlength="256" #message />
            <mat-hint align="start">{{ message.value.length }} / 256</mat-hint>
          </mat-form-field>
          <button
            mat-raised-button
            (click)="
              onSubmit(newComment.value, sitter.userId); newComment.value = ''
            "
            [disabled]="sitter.userId === activeId"
          >
            Add comment
          </button>
          <hr />
          <div *ngIf="isShowComments && comments.length > 0">
            <div *ngFor="let comment of comments">
              <div *ngIf="comment.userId === sitter.userId">
                <span>{{ comment.name }}</span>
                <p>{{ comment.comment }}</p>
              </div>
            </div>
          </div>
        </mat-card-footer>
      </mat-card-content>
    </mat-card>
  </ng-container>